{{- $global := . }}
apiVersion: v1
kind: ConfigMap
metadata:
    name: {{ template "mercury.fullname" . }}-server
    labels:
        app: mercury
        chart: {{ template "workspace.chart" . }}
        release: {{ .Release.Name }}
        heritage: {{ .Release.Service }}
data:
    config.yaml: |-
      urls:
        keycloak: {{ .Values.external.keycloak.baseUrl }}
        elasticsearch: {{ template "elasticsearch.baseurl" . }}
        workspaces:
          {{- range .Values.saturn.nodes }}
          - http://{{ $global.Release.Name }}-saturn-{{.name}}.{{ $global.Release.Namespace }}.svc.cluster.local
          {{- end}}
      keycloak:
        realm: {{ .Values.external.keycloak.realm }}
        clientId: {{ .Values.external.keycloak.clientId }}
        clientSecret: {{ .Values.external.keycloak.clientSecret }}